<html><body><pre style="word-wrap: break-word; white-space: pre-wrap;">#include &lt;cstdio&gt;

int main()
{
    int z;
    scanf("%d\n",&amp;z);
    while(z--)
    {
        int n;
        scanf("%d\n",&amp;n);
        char text[n];
        scanf("%s\n",text);

        int MPNext[n+1],b=-1,w=0;
        MPNext[0]=b;

        /*for(int i=1;i&lt;=n;++i)
        {
            while((b&gt;-1) &amp;&amp; text[i-1]!=text[b])
                b=KMPNext[b];
            ++b;
            if(text[i]!=text[b] || b==n)
            {
                KMPNext[i]=b;
                ++w;
            }
            else
                KMPNext[i]=KMPNext[b];
        }*/

        for(int i=0;i&lt;n;++i)
        {
            while((b&gt;-1) &amp;&amp; text[i]!=text[b])
                b=MPNext[b];
            MPNext[i+1]=++b;
        }

        for(int i=1;i&lt;=n;++i)
            if(i%(i-MPNext[i])==0 &amp;&amp; i/(i-MPNext[i])&gt;1)
                ++w;

        printf("%d\n",w);

        for(int i=1;i&lt;=n;++i)
            if(i%(i-MPNext[i])==0 &amp;&amp; i/(i-MPNext[i])&gt;1)
                printf("%d %d\n",i,i/(i-MPNext[i]));
    }
    return 0;
}</pre></body></html>